<UserControl x:Class="Eng.Chlaot.Modules.RaaSModule.CtrInit"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Eng.Chlaot.Modules.RaaSModule"
             xmlns:cvt="clr-namespace:Eng.Chlaot.ChlaotModuleBase.ModuleUtils.WPF.Converters;assembly=ChlaotModuleBase"             
             xmlns:nav="clr-namespace:Eng.Chlaot.Libs.AirportsLib;assembly=AirportsLib"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
  <UserControl.Resources>
    <cvt:DoubleFormatter x:Key="DoubleFormatter" />
  </UserControl.Resources>  
  <DockPanel>
    <DockPanel DockPanel.Dock="Top">
      <Button x:Name="btnSettings" DockPanel.Dock="Right"
        Margin="8" Padding="8" Click="btnSettings_Click">Settings</Button>
      <Button x:Name="btnLoadAirports" Click="btnLoadAirports_Click" Margin="8" Padding="8">Load Airports</Button>
    </DockPanel>
    <TabControl>
      <TabItem Header="Metainfo">
        <Label>Not applicable</Label>
      </TabItem>
      <TabItem x:Name="tabAirports">
        <TabItem.Header>
          <StackPanel Orientation="Horizontal">
            <TextBlock Text="Airports" />
            <TextBlock x:Name="txtAirportsCount" Text=" (not loaded, rendering will take long)" />
          </StackPanel>
        </TabItem.Header>
        <DockPanel>
          <GroupBox DockPanel.Dock="Top">
            <StackPanel>
              <StackPanel Orientation="Horizontal" Margin="8">
                <TextBlock Text="Filter (regex):" />
                <TextBox Width="100" Text="{Binding FilterRegex, UpdateSourceTrigger=PropertyChanged}" />
              </StackPanel>
            </StackPanel>
          </GroupBox>
          <TreeView ItemsSource="{Binding Airports}">
            <TreeView.Resources>
              <HierarchicalDataTemplate DataType="{x:Type nav:Airport}" ItemsSource="{Binding Runways}">
                <StackPanel Orientation="Horizontal">
                  <TextBlock FontWeight="Bold" Text="{Binding ICAO}" />
                  <TextBlock Text=" - "/>
                  <TextBlock Text="{Binding Name}" />
                  <TextBlock Text=", " />
                  <TextBlock Text="{Binding City}" />
                  <TextBlock Text=", " />
                  <TextBlock Text="{Binding CountryCode}" />
                </StackPanel>
              </HierarchicalDataTemplate>
              <HierarchicalDataTemplate DataType="{x:Type nav:Runway}" ItemsSource="{Binding Thresholds}">
                <StackPanel Orientation="Horizontal">
                  <TextBlock Text="{Binding Designator}" />
                </StackPanel>
              </HierarchicalDataTemplate>
              <HierarchicalDataTemplate DataType="{x:Type nav:RunwayThreshold}">
                <StackPanel Orientation="Horizontal">
                  <TextBlock Text="{Binding Designator}" />
                  <TextBlock Text=" - Loc: " />
                  <TextBlock Text="{Binding Coordinate.Latitude, Converter={StaticResource DoubleFormatter}, ConverterParameter=N5}" />
                  <TextBlock Text=" " />
                  <TextBlock Text="{Binding Coordinate.Longitude, Converter={StaticResource DoubleFormatter}, ConverterParameter=N5}" />
                </StackPanel>
              </HierarchicalDataTemplate>
            </TreeView.Resources>
          </TreeView>
        </DockPanel>
      </TabItem>
    </TabControl>
  </DockPanel>
</UserControl>
